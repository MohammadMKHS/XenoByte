@{
    ViewData["Title"] = "Upload File for Reputation Scan";
}

<link rel="stylesheet" href="~/css/wallet-forensic-report.css" />

<div class="content-section">
    <h2>Upload File for Reputation Scan</h2>
    <p>Upload a file to scan for reputation and security analysis. Maximum file size: 10MB.</p>

    <form asp-action="UploadAndScanFileForReputation" asp-controller="Home" method="post" enctype="multipart/form-data" class="mt-4">
        <div class="section-content">
            <div class="form-group mb-3">
                <label for="file" class="form-label">Select File:</label>
                <input type="file" id="file" name="file" class="form-control" required accept="*/*" />
                <small class="text-muted">Supported formats: All file types (max 10MB)</small>
            </div>
            
            <div class="form-group">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-upload"></i> Upload and Scan File
                </button>
                <a href="@Url.Action("Index", "Home")" class="btn btn-secondary ms-2">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </form>

    <div class="section-content mt-4">
        <h3>What this scan provides:</h3>
        <ul>
            <li><strong>File Hash Analysis:</strong> MD5, SHA1, and SHA256 hashes</li>
            <li><strong>Malware Detection:</strong> Checks against known malicious signatures</li>
            <li><strong>Threat Intelligence:</strong> Associated APT groups and campaigns</li>
            <li><strong>IOC Analysis:</strong> Related IPs, domains, URLs, and other indicators</li>
            <li><strong>File Metadata:</strong> Type, size, and submission history</li>
        </ul>
    </div>
</div>

<script>
// Add file validation
document.getElementById('file').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const maxSize = 10 * 1024 * 1024; // 10MB
        if (file.size > maxSize) {
            alert('File size exceeds 10MB limit. Please select a smaller file.');
            e.target.value = '';
        }
    }
});

// Show loading indicator on form submit
document.querySelector('form').addEventListener('submit', function() {
    const submitBtn = document.querySelector('button[type="submit"]');
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Uploading and Scanning...';
    submitBtn.disabled = true;
});
</script>